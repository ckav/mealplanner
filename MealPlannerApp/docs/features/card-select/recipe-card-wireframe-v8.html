<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Recipe Card Wireframe v8 ‚Äî Sorted Meal Planner</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&display=swap');

  :root {
    --indigo: #4F46E5;
    --indigo-light: #818CF8;
    --indigo-bg: rgba(79,70,229,0.06);
    --red-heart: #EF4444;
    --green: #10B981;
    --green-bg: rgba(16,185,129,0.08);
    --amber: #F59E0B;
    --amber-bg: rgba(245,158,11,0.08);
    --dark: #1E1E2E;
    --grey-900: #111827;
    --grey-700: #374151;
    --grey-600: #4B5563;
    --grey-500: #6B7280;
    --grey-400: #9CA3AF;
    --grey-300: #D1D5DB;
    --grey-200: #E5E7EB;
    --grey-100: #F3F4F6;
    --grey-50: #F9FAFB;
    --white: #FFFFFF;
    --radius: 16px;
    --radius-sm: 10px;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
    --shadow-lg: 0 8px 30px rgba(0,0,0,0.12);
    --shadow-xl: 0 20px 60px rgba(0,0,0,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body {
    font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    background: #F0F0F5;
    display: flex; justify-content: center; align-items: flex-start;
    min-height: 100vh; padding: 20px; color: var(--grey-900);
  }

  /* ====== PHONE ====== */
  .phone {
    width: 390px; max-width: 100%; background: var(--white);
    border-radius: 40px; box-shadow: var(--shadow-xl), 0 0 0 1px rgba(0,0,0,0.05);
    overflow: hidden; position: relative; height: 844px;
    display: flex; flex-direction: column;
  }
  .status-bar {
    display: flex; justify-content: space-between; align-items: center;
    padding: 14px 28px 8px; font-size: 15px; font-weight: 600;
    background: var(--white); flex-shrink: 0;
  }

  /* ====== HEADER ====== */
  .app-header {
    padding: 4px 20px 0; background: var(--white); flex-shrink: 0;
  }
  .header-row {
    display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;
  }
  .app-title { font-size: 24px; font-weight: 700; }
  .app-title span { color: var(--indigo); }

  /* Filter bar placeholder */
  .filter-bar {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 0 10px; border-bottom: 1px solid var(--grey-100);
  }
  .search-pill {
    flex: 1; display: flex; align-items: center; gap: 8px;
    padding: 9px 14px; border-radius: 10px; background: var(--grey-50);
    border: 1px solid var(--grey-200); font-size: 13px; color: var(--grey-400);
  }
  .filter-btn {
    padding: 9px 14px; border-radius: 10px; border: 1px solid var(--grey-200);
    background: var(--white); font-family: inherit; font-size: 13px;
    font-weight: 500; color: var(--grey-600); cursor: pointer;
    display: flex; align-items: center; gap: 4px;
  }

  /* View Toggle */
  .view-toggle {
    display: flex; background: var(--grey-100); border-radius: 10px;
    padding: 3px; gap: 2px; margin-bottom: 0; flex-shrink: 0;
  }
  .view-toggle button {
    flex: 1; padding: 8px 4px; border: none; background: transparent;
    border-radius: 8px; font-family: inherit; font-size: 12px; font-weight: 500;
    color: var(--grey-500); cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; justify-content: center; gap: 4px;
  }
  .view-toggle button.active {
    background: var(--white); color: var(--grey-900); font-weight: 600;
    box-shadow: var(--shadow-sm);
  }

  /* ====== TIER TABS ====== */
  .tier-tabs {
    display: flex; gap: 6px; padding: 10px 20px;
    background: var(--white); border-bottom: 1px solid var(--grey-200);
    overflow-x: auto; flex-shrink: 0;
    -webkit-overflow-scrolling: touch;
  }
  .tier-tabs::-webkit-scrollbar { display: none; }
  .tier-tab {
    display: flex; align-items: center; gap: 6px;
    padding: 7px 14px; border-radius: 20px; border: 1.5px solid var(--grey-200);
    background: var(--white); font-family: inherit; font-size: 13px;
    font-weight: 500; color: var(--grey-500); cursor: pointer; white-space: nowrap;
    transition: all 0.2s;
  }
  .tier-tab .count {
    min-width: 20px; height: 20px; padding: 0 6px; border-radius: 10px;
    font-size: 11px; font-weight: 700; background: var(--grey-100);
    color: var(--grey-500); display: inline-flex; align-items: center;
    justify-content: center; transition: all 0.2s;
  }
  .tier-tab.active { border-color: var(--indigo); background: var(--indigo-bg); color: var(--indigo); }
  .tier-tab.active .count { background: var(--indigo); color: var(--white); }
  .tier-tab.saved-tab.active { border-color: var(--amber); background: var(--amber-bg); color: #B45309; }
  .tier-tab.saved-tab.active .count { background: var(--amber); color: var(--white); }
  .tier-tab.meals-tab.active { border-color: var(--green); background: var(--green-bg); color: #047857; }
  .tier-tab.meals-tab.active .count { background: var(--green); color: var(--white); }

  /* ====== SCREENS ====== */
  .screen { display: none; flex: 1; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; position: relative; }
  .screen.active { display: flex; flex-direction: column; }

  .tier-panel { display: none; flex: 1; overflow-y: auto; }
  .tier-panel.active { display: block; }

  .scrollable-content { flex: 1; overflow-y: auto; position: relative; }

  /* ====== EMPTY STATE ====== */
  .empty-state {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 60px 40px; text-align: center;
  }
  .empty-state .empty-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.8; }
  .empty-state .empty-title { font-size: 17px; font-weight: 600; color: var(--grey-700); margin-bottom: 6px; }
  .empty-state .empty-sub { font-size: 14px; color: var(--grey-400); line-height: 1.5; }

  /* ========================================
     FULL CARD VIEW
     ======================================== */
  .full-cards { padding: 16px 20px 20px; }
  .full-card {
    margin-bottom: 20px; border-radius: var(--radius); overflow: hidden;
    background: var(--white); box-shadow: var(--shadow-md);
    position: relative; transition: opacity 0.3s, transform 0.3s, max-height 0.4s 0.1s, margin 0.4s 0.1s;
  }
  .full-card.dismissed { opacity: 0; transform: translateX(-100%); max-height: 0 !important; margin-bottom: 0; }

  .fc-image-wrap { position: relative; width: 100%; height: 200px; overflow: hidden; }
  .fc-image-placeholder {
    width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 48px;
  }
  .fc-badges { position: absolute; top: 12px; left: 12px; display: flex; gap: 6px; }
  .fc-badge {
    padding: 3px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;
    background: rgba(255,255,255,0.8); backdrop-filter: blur(8px);
    color: var(--grey-600); letter-spacing: 0.3px;
  }
  .fc-new-badge {
    position: absolute; top: 12px; right: 12px; padding: 3px 10px; border-radius: 6px;
    font-size: 11px; font-weight: 600; background: var(--indigo); color: white;
  }
  .fc-heart {
    position: absolute; bottom: 12px; right: 12px; width: 36px; height: 36px;
    border-radius: 50%; background: rgba(255,255,255,0.9); backdrop-filter: blur(8px);
    border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;
    font-size: 18px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .fc-heart:active { transform: scale(0.9); }
  .fc-heart.liked { background: var(--red-heart); color: white; }

  .fc-body { padding: 14px 16px 16px; }
  .fc-name { font-size: 17px; font-weight: 600; margin-bottom: 4px; line-height: 1.3; }
  .fc-meta { display: flex; align-items: center; gap: 10px; font-size: 13px; color: var(--grey-500); margin-bottom: 12px; }
  .fc-tag { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; background: var(--grey-100); color: var(--grey-600); }

  .fc-actions { display: flex; align-items: center; justify-content: space-between; }
  .fc-add-btn {
    display: flex; align-items: center; gap: 6px; padding: 10px 20px;
    border-radius: 10px; border: none; background: var(--indigo); color: white;
    font-family: inherit; font-size: 14px; font-weight: 600; cursor: pointer;
    transition: all 0.15s; user-select: none;
  }
  .fc-add-btn:active { transform: scale(0.96); }
  .fc-add-btn.saved-state { background: var(--amber); }
  .fc-add-btn.meals-state { background: var(--green); }

  .fc-dismiss-btn {
    padding: 8px 12px; border-radius: 8px; border: 1px solid var(--grey-200);
    background: transparent; cursor: pointer; font-family: inherit;
    font-size: 12px; color: var(--grey-400); transition: all 0.15s;
  }
  .fc-dismiss-btn:active { background: var(--grey-50); }

  /* ========================================
     QUICK VIEW
     ======================================== */
  .quick-view { padding: 4px 0 20px; }
  .qv-card-wrapper, .saved-card-wrapper {
    position: relative; overflow: hidden;
    transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.3s ease;
    max-height: 100px;
  }
  .qv-card-wrapper.dismissed, .saved-card-wrapper.dismissed { max-height: 0; opacity: 0; margin: 0; }

  .qv-actions-left, .qv-actions-right {
    position: absolute; top: 0; height: 100%; display: flex; align-items: center; z-index: 1;
  }
  .qv-actions-left { left: 0; }
  .qv-actions-right { right: 0; }

  .qv-action-btn {
    height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 0 16px; border: none; cursor: pointer; font-family: inherit;
    font-size: 10px; font-weight: 600; color: white; gap: 3px; min-width: 68px;
  }
  .qv-action-btn .icon { font-size: 18px; }
  .qv-action-btn.save-action { background: var(--amber); }
  .qv-action-btn.plan-action { background: var(--indigo); }
  .qv-action-btn.skip-action { background: var(--grey-400); }
  .qv-action-btn.nope-action { background: var(--dark); }
  .qv-action-btn.back-action { background: var(--grey-300); color: var(--grey-700); }

  .qv-card, .saved-card {
    display: flex; align-items: center; padding: 10px 20px; gap: 12px;
    background: var(--white); border-bottom: 1px solid var(--grey-100);
    position: relative; z-index: 2; transition: transform 0.25s ease;
    cursor: grab; user-select: none;
  }

  .qv-thumb {
    width: 64px; height: 64px; border-radius: var(--radius-sm);
    overflow: hidden; flex-shrink: 0; position: relative;
  }
  .qv-thumb-placeholder { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 26px; }
  .qv-thumb-badge {
    position: absolute; top: 3px; left: 3px; padding: 1px 5px; border-radius: 4px;
    font-size: 9px; font-weight: 600; background: rgba(255,255,255,0.85);
    backdrop-filter: blur(4px); color: var(--grey-600);
  }

  .qv-info { flex: 1; min-width: 0; }
  .qv-name { font-size: 14px; font-weight: 600; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .qv-details { font-size: 12px; color: var(--grey-500); display: flex; align-items: center; gap: 8px; }
  .qv-tag-small { padding: 1px 6px; border-radius: 3px; font-size: 10px; font-weight: 500; background: var(--grey-100); color: var(--grey-500); }

  .qv-heart {
    width: 30px; height: 30px; border-radius: 50%; border: none; background: transparent;
    cursor: pointer; font-size: 15px; display: flex; align-items: center; justify-content: center;
    flex-shrink: 0; color: var(--grey-300);
  }
  .qv-heart.liked { color: var(--red-heart); }

  /* Saved card visible buttons */
  .saved-actions { display: flex; gap: 6px; flex-shrink: 0; }
  .saved-btn {
    padding: 6px 10px; border-radius: 7px; border: none; font-family: inherit;
    font-size: 11px; font-weight: 600; cursor: pointer; transition: all 0.15s;
  }
  .saved-btn:active { transform: scale(0.95); }
  .saved-btn.add-meals-btn { background: var(--indigo); color: white; }
  .saved-btn.remove-btn { background: var(--grey-100); color: var(--grey-500); }

  /* Meal card with day */
  .meal-card {
    display: flex; align-items: center; padding: 12px 20px; gap: 12px;
    background: var(--white); border-bottom: 1px solid var(--grey-100);
  }
  .meal-day-badge {
    width: 40px; height: 40px; border-radius: 8px;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
    background: var(--green-bg); border: 1.5px solid var(--green);
    font-size: 12px; font-weight: 700; color: #047857; text-transform: uppercase;
  }
  .meal-btn {
    width: 30px; height: 30px; border-radius: 7px; border: 1px solid var(--grey-200);
    background: var(--white); cursor: pointer; display: flex; align-items: center;
    justify-content: center; font-size: 13px; flex-shrink: 0;
  }

  /* ========================================
     SWIPE MODE ‚Äî REDESIGNED
     ======================================== */
  .swipe-mode {
    display: flex; flex-direction: column; align-items: center;
    padding: 16px 20px 20px; flex: 1; justify-content: flex-start;
  }
  .swipe-progress { display: flex; gap: 6px; margin-bottom: 14px; }
  .swipe-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--grey-300); transition: all 0.3s; }
  .swipe-dot.current { background: var(--indigo); transform: scale(1.2); }
  .swipe-dot.added { background: var(--green); }
  .swipe-dot.saved { background: var(--amber); }
  .swipe-dot.skipped { background: var(--grey-400); }

  .swipe-stack { position: relative; width: 340px; height: 420px; margin-bottom: 16px; }
  .swipe-card {
    position: absolute; top: 0; left: 0; width: 100%;
    border-radius: 20px; overflow: hidden; background: var(--white);
    box-shadow: var(--shadow-lg); cursor: grab; user-select: none; touch-action: none;
  }
  .swipe-card.behind-1 { transform: scale(0.95) translateY(10px); z-index: 1; pointer-events: none; }
  .swipe-card.behind-2 { transform: scale(0.90) translateY(20px); z-index: 0; pointer-events: none; }
  .swipe-card.top-card { z-index: 10; }

  .sc-image { width: 100%; height: 260px; position: relative; }
  .sc-image-placeholder { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 56px; }
  .sc-badges { position: absolute; top: 12px; left: 12px; display: flex; gap: 6px; }
  .sc-badge {
    padding: 3px 8px; border-radius: 6px; font-size: 11px; font-weight: 600;
    background: rgba(255,255,255,0.8); backdrop-filter: blur(8px); color: var(--grey-600);
  }
  .sc-new-badge {
    position: absolute; top: 12px; right: 12px; padding: 3px 10px; border-radius: 6px;
    font-size: 11px; font-weight: 600; background: var(--indigo); color: white;
  }
  .sc-stamp {
    position: absolute; top: 50%; transform: translateY(-50%) rotate(-15deg);
    font-size: 28px; font-weight: 800; padding: 8px 18px; border-radius: 10px;
    border: 4px solid; opacity: 0; pointer-events: none; z-index: 20; letter-spacing: 2px;
  }
  .sc-stamp.skip-stamp { right: 16px; color: var(--grey-500); border-color: var(--grey-500); background: rgba(255,255,255,0.9); }
  .sc-stamp.add-stamp { left: 16px; color: var(--green); border-color: var(--green); background: rgba(255,255,255,0.9); }

  .sc-body { padding: 14px 18px 16px; }
  .sc-name { font-size: 19px; font-weight: 700; margin-bottom: 4px; }
  .sc-meta { font-size: 13px; color: var(--grey-500); display: flex; gap: 10px; margin-bottom: 6px; }
  .sc-tags { display: flex; gap: 6px; }
  .sc-tag { padding: 3px 10px; border-radius: 6px; font-size: 12px; font-weight: 500; background: var(--grey-100); color: var(--grey-600); }

  /* Swipe buttons ‚Äî clean row: Save | Add (big) | Heart */
  .swipe-actions-row {
    display: flex; gap: 14px; align-items: center; margin-bottom: 10px;
  }
  .swipe-btn {
    border: none; border-radius: 50%; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; font-family: inherit;
  }
  .swipe-btn:active { transform: scale(0.9); }
  .swipe-btn.save-btn {
    width: 50px; height: 50px; background: #FEF3C7; font-size: 20px; color: #B45309;
    box-shadow: 0 2px 8px rgba(245,158,11,0.15);
  }
  .swipe-btn.add-btn {
    width: 64px; height: 64px; background: var(--indigo); font-size: 26px; color: white;
    box-shadow: 0 4px 16px rgba(79,70,229,0.3);
  }
  .swipe-btn.heart-btn {
    width: 50px; height: 50px; background: var(--grey-100); font-size: 20px; color: var(--grey-400);
  }
  .swipe-btn.heart-btn.liked { background: #FEE2E2; color: var(--red-heart); }

  /* Subtle "not for me" link below buttons */
  .swipe-nope-link {
    font-size: 12px; color: var(--grey-400); cursor: pointer;
    padding: 4px 8px; border: none; background: none; font-family: inherit;
    transition: color 0.15s;
  }
  .swipe-nope-link:active { color: var(--grey-600); }

  /* ====== FOOTER BAR (Saved for Later count) ====== */
  .footer-bar {
    flex-shrink: 0; background: var(--white); border-top: 1px solid var(--grey-200);
    padding: 10px 20px; display: none; align-items: center; justify-content: space-between;
    z-index: 100;
  }
  .footer-bar.visible { display: flex; }
  .footer-info { display: flex; align-items: center; gap: 10px; }
  .footer-thumbs { display: flex; }
  .footer-thumb {
    width: 32px; height: 32px; border-radius: 7px;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px; margin-right: -4px; border: 2px solid var(--white);
    box-shadow: var(--shadow-sm);
  }
  .footer-count { font-size: 13px; font-weight: 600; color: var(--grey-700); }
  .footer-review {
    padding: 8px 18px; border-radius: 9px; border: none;
    background: var(--amber); color: white; font-family: inherit;
    font-size: 13px; font-weight: 600; cursor: pointer;
  }

  /* ====== SPEC ====== */
  .spec-view { padding: 20px 20px 40px; }
  .spec-section { margin-bottom: 24px; }
  .spec-title { font-size: 17px; font-weight: 700; margin-bottom: 8px; color: var(--indigo); }
  .spec-text { font-size: 13px; line-height: 1.6; color: var(--grey-600); }
  .spec-flow {
    font-family: 'DM Sans', monospace; font-size: 12px;
    background: var(--grey-50); border: 1px solid var(--grey-200);
    border-radius: 10px; padding: 14px; margin: 8px 0;
    line-height: 1.8; white-space: pre-wrap; color: var(--grey-700);
  }
  .spec-divider { height: 1px; background: var(--grey-200); margin: 20px 0; }

  /* ====== OVERLAYS ====== */
  .toast-container {
    position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
    z-index: 1000; display: flex; flex-direction: column; gap: 8px;
    align-items: center; pointer-events: none; width: 350px;
  }
  .toast {
    padding: 12px 20px; border-radius: 12px; font-size: 14px; font-weight: 500;
    color: white; text-align: center; pointer-events: auto; box-shadow: var(--shadow-lg);
    width: 100%; animation: toastIn 0.3s ease, toastOut 0.3s ease 2.5s forwards;
  }
  .toast.info { background: var(--grey-700); }
  .toast.success { background: var(--green); }
  .toast.amber { background: var(--amber); }
  @keyframes toastIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes toastOut { from { opacity: 1; } to { opacity: 0; } }

  .dismiss-banner {
    padding: 12px 16px; border-radius: 12px; background: var(--grey-900);
    color: white; display: flex; align-items: center; justify-content: space-between;
    gap: 10px; font-size: 13px; pointer-events: auto; box-shadow: var(--shadow-xl);
    animation: bannerIn 0.3s ease; width: 100%;
  }
  .dismiss-banner .banner-text { flex: 1; }
  .dismiss-banner .subtle { opacity: 0.6; font-size: 11px; }
  .dismiss-banner .tell-why-btn {
    padding: 6px 12px; border-radius: 7px; border: 1px solid rgba(255,255,255,0.3);
    background: transparent; color: white; font-family: inherit; font-size: 12px;
    font-weight: 600; cursor: pointer; white-space: nowrap;
  }
  .dismiss-banner.fading-out { animation: bannerOut 0.5s ease forwards; }
  @keyframes bannerIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes bannerOut { from { opacity: 1; } to { opacity: 0; transform: translateY(20px); } }

  .overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.4); z-index: 2000; }
  .overlay.active { display: block; }
  .bottom-sheet {
    display: none; position: fixed; bottom: 0; left: 0; right: 0;
    background: var(--white); border-radius: 20px 20px 0 0; z-index: 2001;
    padding: 8px 24px 40px; animation: sheetUp 0.3s ease;
  }
  .bottom-sheet.active { display: block; }
  @keyframes sheetUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
  .sheet-handle { width: 36px; height: 4px; border-radius: 2px; background: var(--grey-300); margin: 4px auto 16px; }
  .sheet-title { font-size: 18px; font-weight: 700; margin-bottom: 16px; }
  .sheet-option {
    display: flex; align-items: center; gap: 14px; padding: 14px 8px;
    border-bottom: 1px solid var(--grey-100); cursor: pointer; border-radius: 8px; margin: 0 -8px;
  }
  .sheet-option:last-child { border-bottom: none; }
  .sheet-option:active { background: var(--grey-50); }
  .sheet-option .opt-icon { width: 38px; height: 38px; border-radius: 9px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
  .sheet-option .opt-icon.recipe-icon { background: var(--grey-100); }
  .sheet-option .opt-icon.ingredient-icon { background: #ECFDF5; }
  .sheet-option .opt-icon.cuisine-icon { background: #EFF6FF; }
  .sheet-option .opt-text { font-size: 15px; font-weight: 500; }
  .sheet-option .opt-sub { font-size: 12px; color: var(--grey-500); margin-top: 1px; }

  .day-picker-overlay {
    display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.3); z-index: 3000;
  }
  .day-picker-overlay.active { display: flex; align-items: center; justify-content: center; }
  .day-picker { background: var(--white); border-radius: 20px; padding: 20px 24px 24px; width: 290px; box-shadow: var(--shadow-xl); animation: popIn 0.2s ease; }
  @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  .day-picker h3 { font-size: 16px; font-weight: 700; margin-bottom: 14px; }
  .day-picker-list { display: flex; flex-direction: column; gap: 3px; }
  .day-option {
    display: flex; align-items: center; justify-content: space-between;
    padding: 9px 12px; border-radius: 9px; cursor: pointer; border: none;
    background: transparent; width: 100%; font-family: inherit; font-size: 14px; text-align: left;
  }
  .day-option:active { background: var(--grey-100); }
  .day-option .day-label { font-weight: 500; }
  .day-option .day-status { font-size: 12px; color: var(--grey-400); }
  .day-option .day-status.filled { color: var(--green); }
  .day-option.first-empty { background: var(--indigo-bg); }
  .day-option.first-empty .day-label { color: var(--indigo); font-weight: 600; }
  .day-picker-alt { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--grey-200); }
  .day-picker-alt button {
    width: 100%; padding: 9px; border: none; background: transparent;
    font-family: inherit; font-size: 13px; color: var(--grey-500); cursor: pointer; border-radius: 8px;
  }

  .home-indicator {
    position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%);
    width: 134px; height: 5px; border-radius: 3px; background: var(--grey-900); opacity: 0.15;
  }
</style>
</head>
<body>

<div class="phone">
  <div class="status-bar"><span>09:41</span><span>üì∂ üîã</span></div>

  <div class="app-header">
    <div class="header-row">
      <div class="app-title">üçΩÔ∏è <span>Sorted</span> Recipes</div>
    </div>
    <div class="filter-bar">
      <div class="search-pill">üîç Search recipes...</div>
      <button class="filter-btn">‚ò∞ Filters</button>
    </div>
    <div class="view-toggle">
      <button class="active" data-view="full">üÉè Full</button>
      <button data-view="quick">üìã Quick</button>
      <button data-view="swipe">üí´ Swipe</button>
      <button data-view="spec">üìê Spec</button>
    </div>
  </div>

  <div class="tier-tabs" id="tierTabs">
    <button class="tier-tab active" data-tier="browse">üîç Browse <span class="count" id="browseCount">8</span></button>
    <button class="tier-tab saved-tab" data-tier="saved">üîñ Saved <span class="count" id="savedCount">0</span></button>
    <button class="tier-tab meals-tab" data-tier="meals">‚úÖ This Week <span class="count" id="mealsCount">0</span></button>
  </div>

  <!-- FULL -->
  <div class="screen active" id="fullScreen">
    <div class="tier-panel active" data-tier="browse"><div class="full-cards" id="fullBrowseCards"></div></div>
    <div class="tier-panel" data-tier="saved"><div class="full-cards" id="fullSavedCards"></div></div>
    <div class="tier-panel" data-tier="meals"><div class="full-cards" id="fullMealsCards"></div></div>
  </div>

  <!-- QUICK -->
  <div class="screen" id="quickScreen">
    <div class="tier-panel active" data-tier="browse"><div class="quick-view" id="quickBrowseCards"></div></div>
    <div class="tier-panel" data-tier="saved"><div class="quick-view" id="quickSavedCards"></div></div>
    <div class="tier-panel" data-tier="meals"><div class="quick-view" id="quickMealsCards"></div></div>
  </div>

  <!-- SWIPE -->
  <div class="screen" id="swipeScreen">
    <div class="swipe-mode">
      <div class="swipe-progress" id="swipeDots"></div>
      <div class="swipe-stack" id="swipeStack"></div>
      <div class="swipe-actions-row">
        <button class="swipe-btn save-btn" id="swipeSaveBtn" title="Save for later">üîñ</button>
        <button class="swipe-btn add-btn" id="swipeAddBtn" title="Add to meals">Ôºã</button>
        <button class="swipe-btn heart-btn" id="swipeHeartBtn" title="Favourite">ü§ç</button>
      </div>
      <button class="swipe-nope-link" id="swipeNopeLink">Not for me ‚Äî don't show again</button>
    </div>
  </div>

  <!-- SPEC -->
  <div class="screen" id="specScreen">
    <div class="spec-view">
      <div class="spec-section">
        <div class="spec-title">v8 Final Spec ‚Äî Recipe Cards</div>
        <p class="spec-text">Three-tier system (Browse ‚Üí Saved ‚Üí Meals) with three browsing modes (Full / Quick / Swipe). Consistent actions, zero-friction dismiss, pattern learning.</p>
      </div>
      <div class="spec-divider"></div>
      <div class="spec-section">
        <div class="spec-title">Swipe Mode Buttons</div>
        <div class="spec-flow">üîñ Save for Later ‚Äî amber circle
Ôºã Add to Meals ‚Äî large indigo (primary action)
ü§ç Heart ‚Äî favourite

Swipe left = skip (gesture only, no button)
"Not for me" = subtle text link below buttons

Skip via swipe keeps the button row clean.
"Not for me" is deliberately low-key ‚Äî it's
a considered action, not a reflex.</div>
      </div>
      <div class="spec-divider"></div>
      <div class="spec-section">
        <div class="spec-title">Three Tiers</div>
        <div class="spec-flow">üîç Browse (indigo)
  All recipes. Swipe/tap to triage.
  Actions: Save / Add / Skip / Not for me

üîñ Saved for Later (amber)
  "Interested but not this week"
  Buttons: [üìÖ Meals] [‚úï Remove]
  Swipeable: right=meals, left=back to browse

‚úÖ This Week (green)
  Committed meals with day badges.
  Remove ‚Üí back to Saved (never lost)</div>
      </div>
      <div class="spec-divider"></div>
      <div class="spec-section">
        <div class="spec-title">Dismiss Flow</div>
        <div class="spec-flow">üëé / "Not for me" ‚Üí instant dismiss
‚Üí Banner: "Won't suggest again ¬∑ Tell us why?"
‚Üí 4s auto-fade if ignored
‚Üí If tapped:
  üôà Just this recipe ‚Üí done
  ü•¶ An ingredient ‚Üí "less like this"
  üåç The cuisine ‚Üí "less like this"

Pattern learning from accumulated signals.
Settings shows inferred preferences.</div>
      </div>
      <div class="spec-divider"></div>
      <div class="spec-section">
        <div class="spec-title">Footer Bar</div>
        <div class="spec-flow">Fixed at bottom, appears when saved > 0.
Shows: thumbnails + count + "Review ‚Üí"
Visually separated from cards above.
Tapping Review ‚Üí switches to Saved tier tab.</div>
      </div>
    </div>
  </div>

  <!-- Footer bar for saved count -->
  <div class="footer-bar" id="footerBar">
    <div class="footer-info">
      <div class="footer-thumbs" id="footerThumbs"></div>
      <span class="footer-count" id="footerCount">0 saved</span>
    </div>
    <button class="footer-review" id="footerReview">Review ‚Üí</button>
  </div>

  <div class="home-indicator"></div>
</div>

<div class="toast-container" id="toastContainer"></div>
<div class="overlay" id="overlay"></div>
<div class="bottom-sheet" id="bottomSheet">
  <div class="sheet-handle"></div>
  <div class="sheet-title">Why not this one?</div>
  <div class="sheet-option" data-reason="recipe"><div class="opt-icon recipe-icon">üôà</div><div><div class="opt-text">Just this recipe</div><div class="opt-sub">Hide it, no big deal</div></div></div>
  <div class="sheet-option" data-reason="ingredient"><div class="opt-icon ingredient-icon">ü•¶</div><div><div class="opt-text">Don't like an ingredient</div><div class="opt-sub">We'll show less like this</div></div></div>
  <div class="sheet-option" data-reason="cuisine"><div class="opt-icon cuisine-icon">üåç</div><div><div class="opt-text">Not into this cuisine</div><div class="opt-sub">We'll show less like this</div></div></div>
</div>
<div class="day-picker-overlay" id="dayPickerOverlay">
  <div class="day-picker">
    <h3>üìÖ Which day?</h3>
    <div class="day-picker-list" id="dayPickerList"></div>
    <div class="day-picker-alt"><button id="justSaveBtn">Just save for later</button></div>
  </div>
</div>

<script>
const allRecipes = [
  { id:1, name:'Thai Green Curry', time:'25 min', tags:['One Pot'], badges:['DF'], emoji:'üçõ', isNew:true, cuisine:'Thai' },
  { id:2, name:'Beer Battered Fish & Chips', time:'35 min', tags:['Classic'], badges:['DF'], emoji:'üêü', isNew:false, cuisine:'British' },
  { id:3, name:'Mushroom Risotto', time:'40 min', tags:['Vegetarian'], badges:['GF','V'], emoji:'üçÑ', isNew:false, cuisine:'Italian' },
  { id:4, name:'Chicken Fajitas', time:'20 min', tags:['Quick'], badges:['GF'], emoji:'üåÆ', isNew:true, cuisine:'Mexican' },
  { id:5, name:'Prawn Pad Thai', time:'25 min', tags:['High Protein'], badges:['DF','GF'], emoji:'üçú', isNew:false, cuisine:'Thai' },
  { id:6, name:'Lamb Tagine', time:'55 min', tags:['Slow Cook'], badges:['GF','DF'], emoji:'ü•ò', isNew:true, cuisine:'Moroccan' },
  { id:7, name:'Veggie Stir Fry', time:'15 min', tags:['Quick'], badges:['V','DF','GF'], emoji:'ü•¶', isNew:false, cuisine:'Chinese' },
  { id:8, name:'Spaghetti Carbonara', time:'20 min', tags:['Classic'], badges:[], emoji:'üçù', isNew:false, cuisine:'Italian' },
];
const bg = ['#FFF7ED','#F0FDF4','#EFF6FF','#FDF2F8','#F5F3FF','#FFFBEB','#ECFDF5','#FEF2F2'];
const DAYS = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];

let browse=[...allRecipes], saved=[], meals=[], favs=new Set(), weekPlan={};
DAYS.forEach(d=>weekPlan[d]=null);
let currentView='full', currentTier='browse';

function moveTo(id,target,day){
  const r=allRecipes.find(x=>x.id===id); if(!r) return;
  browse=browse.filter(x=>x.id!==id);
  saved=saved.filter(x=>x.id!==id);
  const oldMeal=meals.find(m=>m.recipe.id===id);
  if(oldMeal&&oldMeal.day) weekPlan[oldMeal.day]=null;
  meals=meals.filter(m=>m.recipe.id!==id);
  if(target==='saved') saved.push(r);
  else if(target==='meals'){ const d=day||firstEmpty(); if(d) weekPlan[d]=r; meals.push({recipe:r,day:d}); }
  else if(target==='browse'){ browse.push(r); browse.sort((a,b)=>a.id-b.id); }
  updateUI();
}
function firstEmpty(){ return DAYS.find(d=>!weekPlan[d])||null; }
function updateUI(){ updateCounts(); updateFooter(); renderCurrentView(); }
function updateCounts(){
  document.getElementById('browseCount').textContent=browse.length;
  document.getElementById('savedCount').textContent=saved.length;
  document.getElementById('mealsCount').textContent=meals.length;
}
function updateFooter(){
  const bar=document.getElementById('footerBar');
  const thumbs=document.getElementById('footerThumbs');
  const count=document.getElementById('footerCount');
  if(saved.length>0 && currentTier==='browse'){
    bar.classList.add('visible');
    thumbs.innerHTML=saved.slice(0,4).map(r=>`<div class="footer-thumb" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>`).join('');
    count.textContent=`${saved.length} saved`;
  } else { bar.classList.remove('visible'); }
}

// View toggle
document.querySelectorAll('.view-toggle button').forEach(b=>{
  b.addEventListener('click',()=>{
    document.querySelectorAll('.view-toggle button').forEach(x=>x.classList.remove('active'));
    b.classList.add('active'); currentView=b.dataset.view;
    document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
    document.getElementById(b.dataset.view+'Screen').classList.add('active');
    document.getElementById('tierTabs').style.display=(currentView==='swipe'||currentView==='spec')?'none':'flex';
    updateUI();
  });
});
// Tier toggle
document.querySelectorAll('.tier-tab').forEach(t=>{
  t.addEventListener('click',()=>{
    document.querySelectorAll('.tier-tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active'); currentTier=t.dataset.tier;
    document.querySelectorAll('.screen.active .tier-panel').forEach(p=>p.classList.remove('active'));
    const p=document.querySelector(`.screen.active .tier-panel[data-tier="${currentTier}"]`);
    if(p) p.classList.add('active');
    updateUI();
  });
});
// Footer review
document.getElementById('footerReview').addEventListener('click',()=>{
  document.querySelectorAll('.tier-tab').forEach(x=>x.classList.remove('active'));
  document.querySelector('.tier-tab.saved-tab').classList.add('active');
  currentTier='saved';
  document.querySelectorAll('.screen.active .tier-panel').forEach(p=>p.classList.remove('active'));
  const p=document.querySelector(`.screen.active .tier-panel[data-tier="saved"]`);
  if(p) p.classList.add('active');
  updateUI();
});

function renderCurrentView(){
  if(currentView==='full'||currentView==='quick'){
    if(currentTier==='browse') currentView==='full'?renderFullBrowse():renderQuickBrowse();
    else if(currentTier==='saved') currentView==='full'?renderFullSaved():renderQuickSaved();
    else currentView==='full'?renderFullMeals():renderQuickMeals();
  }
}

// Toast
function toast(msg,type='info'){ const c=document.getElementById('toastContainer'),t=document.createElement('div'); t.className=`toast ${type}`; t.textContent=msg; c.appendChild(t); setTimeout(()=>t.remove(),3000); }

// Dismiss banner
let activeBanner=null;
function dismissBanner(name){
  const c=document.getElementById('toastContainer');
  if(activeBanner) activeBanner.remove();
  const b=document.createElement('div'); b.className='dismiss-banner';
  b.innerHTML=`<div class="banner-text">Won't suggest <b>${name}</b> again<div class="subtle">Your browsing helps us learn</div></div><button class="tell-why-btn">Tell us why?</button>`;
  c.appendChild(b); activeBanner=b;
  b.querySelector('.tell-why-btn').addEventListener('click',()=>{b.remove();activeBanner=null;openSheet();});
  setTimeout(()=>{if(b.parentNode){b.classList.add('fading-out');setTimeout(()=>{b.remove();activeBanner=null;},500);}},4000);
}
function openSheet(){document.getElementById('overlay').classList.add('active');document.getElementById('bottomSheet').classList.add('active');}
function closeSheet(){document.getElementById('overlay').classList.remove('active');document.getElementById('bottomSheet').classList.remove('active');}
document.getElementById('overlay').addEventListener('click',closeSheet);
document.querySelectorAll('.sheet-option').forEach(o=>o.addEventListener('click',()=>{closeSheet();toast(o.dataset.reason==='recipe'?'Got it ‚Äî hidden ‚úì':"We'll show less like this "+(o.dataset.reason==='ingredient'?'ü•¶':'üåç'),'success');}));

// Day picker
let dpCb=null;
function openDayPicker(cb){
  dpCb=cb; const list=document.getElementById('dayPickerList'); list.innerHTML='';
  let fe=true;
  DAYS.forEach(d=>{
    const m=weekPlan[d], empty=!m, btn=document.createElement('button');
    btn.className='day-option'+(empty&&fe?' first-empty':'');
    if(empty&&fe) fe=false;
    btn.innerHTML=`<span class="day-label">${d}</span><span class="day-status ${m?'filled':''}">${m?'‚úì '+m.name:'‚Äî'}</span>`;
    btn.addEventListener('click',()=>{closeDayPicker();if(cb)cb(d);});
    list.appendChild(btn);
  });
  document.getElementById('dayPickerOverlay').classList.add('active');
}
function closeDayPicker(){document.getElementById('dayPickerOverlay').classList.remove('active');}
document.getElementById('dayPickerOverlay').addEventListener('click',e=>{if(e.target===document.getElementById('dayPickerOverlay'))closeDayPicker();});
document.getElementById('justSaveBtn').addEventListener('click',()=>{closeDayPicker();if(dpCb)dpCb(null);});

function toggleFav(id){if(favs.has(id))favs.delete(id);else{favs.add(id);toast('Favourited ‚ù§Ô∏è','success');}}

// ===== FULL CARD RENDERS =====
function renderFullBrowse(){
  const c=document.getElementById('fullBrowseCards');
  if(!browse.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">üéâ</div><div class="empty-title">All caught up!</div><div class="empty-sub">Check Saved or This Week.</div></div>';return;}
  c.innerHTML=browse.map(r=>`
    <div class="full-card" data-id="${r.id}" style="max-height:380px">
      <div class="fc-image-wrap">
        <div class="fc-image-placeholder" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>
        <div class="fc-badges">${r.badges.map(b=>`<span class="fc-badge">${b}</span>`).join('')}</div>
        ${r.isNew?'<span class="fc-new-badge">New</span>':''}
        <button class="fc-heart ${favs.has(r.id)?'liked':''}" data-id="${r.id}">${favs.has(r.id)?'‚ù§Ô∏è':'ü§ç'}</button>
      </div>
      <div class="fc-body">
        <div class="fc-name">${r.name}</div>
        <div class="fc-meta"><span>‚è± ${r.time}</span>${r.tags.map(t=>`<span class="fc-tag">${t}</span>`).join('')}</div>
        <div class="fc-actions">
          <button class="fc-add-btn" data-id="${r.id}">üîñ Save for Later</button>
          <button class="fc-dismiss-btn" data-id="${r.id}" data-name="${r.name}">Not for me</button>
        </div>
      </div>
    </div>`).join('');
  bindFullBrowse(c);
}
function bindFullBrowse(c){
  c.querySelectorAll('.fc-heart').forEach(b=>b.addEventListener('click',e=>{e.stopPropagation();toggleFav(+b.dataset.id);renderFullBrowse();}));
  c.querySelectorAll('.fc-add-btn').forEach(b=>{
    let lp,lpF=false;
    const start=()=>{lpF=false;lp=setTimeout(()=>{lpF=true;openDayPicker(d=>{if(d){moveTo(+b.dataset.id,'meals',d);toast(`Added to ${d}! üìÖ`,'success');}else{moveTo(+b.dataset.id,'saved');toast('üîñ Saved!','amber');}});},600);};
    b.addEventListener('mousedown',start);b.addEventListener('touchstart',start,{passive:true});
    b.addEventListener('mouseup',()=>clearTimeout(lp));b.addEventListener('mouseleave',()=>clearTimeout(lp));
    b.addEventListener('touchend',()=>clearTimeout(lp));b.addEventListener('touchcancel',()=>clearTimeout(lp));
    b.addEventListener('click',()=>{if(lpF)return;moveTo(+b.dataset.id,'saved');toast('üîñ Saved!','amber');});
  });
  c.querySelectorAll('.fc-dismiss-btn').forEach(b=>b.addEventListener('click',()=>{
    const card=b.closest('.full-card');card.style.maxHeight=card.offsetHeight+'px';
    requestAnimationFrame(()=>card.classList.add('dismissed'));
    moveTo(+b.dataset.id,'dismiss');dismissBanner(b.dataset.name);
  }));
}

function renderFullSaved(){
  const c=document.getElementById('fullSavedCards');
  if(!saved.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">üîñ</div><div class="empty-title">Nothing saved yet</div><div class="empty-sub">Save recipes from Browse to see them here.</div></div>';return;}
  c.innerHTML=saved.map(r=>`
    <div class="full-card" data-id="${r.id}" style="max-height:380px">
      <div class="fc-image-wrap">
        <div class="fc-image-placeholder" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>
        <div class="fc-badges">${r.badges.map(b=>`<span class="fc-badge">${b}</span>`).join('')}</div>
        <button class="fc-heart ${favs.has(r.id)?'liked':''}" data-id="${r.id}">${favs.has(r.id)?'‚ù§Ô∏è':'ü§ç'}</button>
      </div>
      <div class="fc-body">
        <div class="fc-name">${r.name}</div>
        <div class="fc-meta"><span>‚è± ${r.time}</span>${r.tags.map(t=>`<span class="fc-tag">${t}</span>`).join('')}</div>
        <div class="fc-actions">
          <button class="fc-add-btn meals-state" data-id="${r.id}">üìÖ Add to Meals</button>
          <button class="fc-dismiss-btn" data-id="${r.id}">Remove</button>
        </div>
      </div>
    </div>`).join('');
  c.querySelectorAll('.fc-heart').forEach(b=>b.addEventListener('click',e=>{e.stopPropagation();toggleFav(+b.dataset.id);renderFullSaved();}));
  c.querySelectorAll('.fc-add-btn').forEach(b=>b.addEventListener('click',()=>openDayPicker(d=>{if(d){moveTo(+b.dataset.id,'meals',d);toast(`Added to ${d}!`,'success');}})));
  c.querySelectorAll('.fc-dismiss-btn').forEach(b=>b.addEventListener('click',()=>{moveTo(+b.dataset.id,'browse');toast('Back in browse','info');}));
}

function renderFullMeals(){
  const c=document.getElementById('fullMealsCards');
  if(!meals.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">‚úÖ</div><div class="empty-title">No meals yet</div><div class="empty-sub">Add recipes to plan your week.</div></div>';return;}
  c.innerHTML=meals.map(m=>`
    <div class="meal-card"><div class="meal-day-badge">${m.day||'?'}</div>
      <div class="qv-thumb"><div class="qv-thumb-placeholder" style="background:${bg[m.recipe.id%bg.length]}">${m.recipe.emoji}</div></div>
      <div class="qv-info"><div class="qv-name">${m.recipe.name}</div><div class="qv-details"><span>‚è± ${m.recipe.time}</span></div></div>
      <button class="meal-btn" data-id="${m.recipe.id}">‚úï</button>
    </div>`).join('');
  c.querySelectorAll('.meal-btn').forEach(b=>b.addEventListener('click',()=>{moveTo(+b.dataset.id,'saved');toast('Moved to Saved üîñ','amber');}));
}

// ===== QUICK VIEW RENDERS =====
function renderQuickBrowse(){
  const c=document.getElementById('quickBrowseCards');
  if(!browse.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">üéâ</div><div class="empty-title">All caught up!</div><div class="empty-sub">Check Saved or This Week.</div></div>';return;}
  c.innerHTML=browse.map(r=>`
    <div class="qv-card-wrapper" data-id="${r.id}">
      <div class="qv-actions-left">
        <button class="qv-action-btn save-action" data-action="save"><span class="icon">üîñ</span>Save</button>
        <button class="qv-action-btn plan-action" data-action="plan"><span class="icon">üìÖ</span>Add</button>
      </div>
      <div class="qv-actions-right">
        <button class="qv-action-btn skip-action" data-action="skip"><span class="icon">‚è≠</span>Skip</button>
        <button class="qv-action-btn nope-action" data-action="nope"><span class="icon">‚úï</span>Not for me</button>
      </div>
      <div class="qv-card">
        <div class="qv-thumb"><div class="qv-thumb-placeholder" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>
          ${r.badges.length?`<span class="qv-thumb-badge">${r.badges[0]}</span>`:''}
        </div>
        <div class="qv-info"><div class="qv-name">${r.name}</div><div class="qv-details"><span>‚è± ${r.time}</span>${r.tags.slice(0,1).map(t=>`<span class="qv-tag-small">${t}</span>`).join('')}</div></div>
        <button class="qv-heart ${favs.has(r.id)?'liked':''}" data-id="${r.id}">${favs.has(r.id)?'‚ù§Ô∏è':'ü§ç'}</button>
      </div>
    </div>`).join('');
  initSwipeable('quickBrowseCards','browse');
}

function renderQuickSaved(){
  const c=document.getElementById('quickSavedCards');
  if(!saved.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">üîñ</div><div class="empty-title">Nothing saved</div><div class="empty-sub">Save from Browse to see them here.</div></div>';return;}
  c.innerHTML=saved.map(r=>`
    <div class="saved-card-wrapper" data-id="${r.id}">
      <div class="qv-actions-left"><button class="qv-action-btn plan-action" data-action="plan"><span class="icon">üìÖ</span>Add to Meals</button></div>
      <div class="qv-actions-right"><button class="qv-action-btn back-action" data-action="back"><span class="icon">‚Ü©</span>Back</button></div>
      <div class="saved-card">
        <div class="qv-thumb"><div class="qv-thumb-placeholder" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>
          ${r.badges.length?`<span class="qv-thumb-badge">${r.badges[0]}</span>`:''}
        </div>
        <div class="qv-info"><div class="qv-name">${r.name}</div><div class="qv-details"><span>‚è± ${r.time}</span></div></div>
        <div class="saved-actions">
          <button class="saved-btn add-meals-btn" data-id="${r.id}">üìÖ Meals</button>
          <button class="saved-btn remove-btn" data-id="${r.id}">‚úï</button>
        </div>
      </div>
    </div>`).join('');
  c.querySelectorAll('.add-meals-btn').forEach(b=>b.addEventListener('click',e=>{e.stopPropagation();openDayPicker(d=>{if(d){moveTo(+b.dataset.id,'meals',d);toast(`Added to ${d}!`,'success');}});}));
  c.querySelectorAll('.remove-btn').forEach(b=>b.addEventListener('click',e=>{e.stopPropagation();const w=b.closest('.saved-card-wrapper');w.classList.add('dismissed');setTimeout(()=>{moveTo(+b.dataset.id,'browse');toast('Back in browse','info');},400);}));
  initSwipeable('quickSavedCards','saved');
}

function renderQuickMeals(){
  const c=document.getElementById('quickMealsCards');
  if(!meals.length){c.innerHTML='<div class="empty-state"><div class="empty-icon">‚úÖ</div><div class="empty-title">No meals yet</div><div class="empty-sub">Add from Browse or Saved.</div></div>';return;}
  c.innerHTML=meals.map(m=>`
    <div class="meal-card"><div class="meal-day-badge">${m.day||'?'}</div>
      <div class="qv-thumb"><div class="qv-thumb-placeholder" style="background:${bg[m.recipe.id%bg.length]}">${m.recipe.emoji}</div></div>
      <div class="qv-info"><div class="qv-name">${m.recipe.name}</div><div class="qv-details"><span>‚è± ${m.recipe.time}</span></div></div>
      <button class="meal-btn" data-id="${m.recipe.id}">‚úï</button>
    </div>`).join('');
  c.querySelectorAll('.meal-btn').forEach(b=>b.addEventListener('click',()=>{moveTo(+b.dataset.id,'saved');toast('Moved to Saved üîñ','amber');}));
}

// ===== SWIPEABLE (iOS MAIL) =====
function initSwipeable(containerId,context){
  document.getElementById(containerId).querySelectorAll('.qv-card, .saved-card').forEach(card=>{
    let sx=0,cx=0,drag=false,open=false,oDir=null;
    const w=card.closest('.qv-card-wrapper,.saved-card-wrapper'),R=68,A=210;
    function onS(e){const t=e.touches?e.touches[0]:e;sx=t.clientX-(open?(oDir==='right'?R*2:-R*2):0);drag=true;card.style.transition='none';}
    function onM(e){if(!drag)return;const t=e.touches?e.touches[0]:e;cx=Math.max(-A-20,Math.min(A+20,t.clientX-sx));card.style.transform=`translateX(${cx}px)`;}
    function onE(){
      if(!drag)return;drag=false;card.style.transition='transform 0.25s ease';const id=+w.dataset.id;
      if(cx>A){card.style.transform='translateX(400px)';setTimeout(()=>{w.classList.add('dismissed');if(context==='browse')openDayPicker(d=>{if(d){moveTo(id,'meals',d);toast(`Added to ${d}!`,'success');}else{moveTo(id,'saved');toast('üîñ Saved!','amber');}});else openDayPicker(d=>{if(d){moveTo(id,'meals',d);toast(`Added to ${d}!`,'success');}});},250);return;}
      if(cx<-A){card.style.transform='translateX(-400px)';setTimeout(()=>{w.classList.add('dismissed');if(context==='browse')toast("Skipped üëã",'info');else{moveTo(id,'browse');toast('Back in browse','info');}},250);return;}
      if(cx>R/2){card.style.transform=`translateX(${R*2}px)`;open=true;oDir='right';}
      else if(cx<-R/2){card.style.transform=`translateX(-${R*2}px)`;open=true;oDir='left';}
      else{card.style.transform='translateX(0)';open=false;oDir=null;}
    }
    card.addEventListener('touchstart',onS,{passive:true});card.addEventListener('touchmove',onM,{passive:true});card.addEventListener('touchend',onE);
    card.addEventListener('mousedown',onS);document.addEventListener('mousemove',onM);document.addEventListener('mouseup',onE);
    card.addEventListener('click',()=>{if(open){card.style.transition='transform 0.25s ease';card.style.transform='translateX(0)';open=false;oDir=null;}});
    w.querySelectorAll('.qv-action-btn').forEach(b=>b.addEventListener('click',e=>{
      e.stopPropagation();const a=b.dataset.action,id=+w.dataset.id,nm=w.querySelector('.qv-name').textContent;
      if(a==='save'){card.style.transform='translateX(0)';open=false;moveTo(id,'saved');toast('üîñ Saved!','amber');}
      else if(a==='plan'){card.style.transform='translateX(400px)';setTimeout(()=>w.classList.add('dismissed'),250);openDayPicker(d=>{if(d){moveTo(id,'meals',d);toast(`Added to ${d}!`,'success');}});}
      else if(a==='skip'){card.style.transform='translateX(-400px)';setTimeout(()=>w.classList.add('dismissed'),250);toast("Skipped üëã",'info');}
      else if(a==='nope'){card.style.transform='translateX(-400px)';setTimeout(()=>{w.classList.add('dismissed');moveTo(id,'dismiss');},250);dismissBanner(nm);}
      else if(a==='back'){card.style.transform='translateX(-400px)';setTimeout(()=>{w.classList.add('dismissed');moveTo(id,'browse');toast('Back in browse','info');},400);}
    }));
    w.querySelectorAll('.qv-heart').forEach(h=>h.addEventListener('click',e=>{e.stopPropagation();toggleFav(+h.dataset.id);h.classList.toggle('liked');h.textContent=h.classList.contains('liked')?'‚ù§Ô∏è':'ü§ç';}));
  });
}

// ===== SWIPE MODE =====
let swipeIdx=0;
function renderSwipe(){
  document.getElementById('swipeDots').innerHTML=browse.slice(0,7).map((_,i)=>`<div class="swipe-dot ${i===0?'current':''}"></div>`).join('');
  updateSwipeStack();
}
function updateSwipeStack(){
  const s=document.getElementById('swipeStack');s.innerHTML='';
  browse.slice(swipeIdx,swipeIdx+3).forEach((r,i)=>{
    const c=document.createElement('div');
    c.className='swipe-card'+(i===0?' top-card':i===1?' behind-1':' behind-2');
    c.innerHTML=`<div class="sc-image"><div class="sc-image-placeholder" style="background:${bg[r.id%bg.length]}">${r.emoji}</div>
      <div class="sc-badges">${r.badges.map(b=>`<span class="sc-badge">${b}</span>`).join('')}</div>
      ${r.isNew?'<span class="sc-new-badge">New</span>':''}
      <div class="sc-stamp skip-stamp">SKIP</div><div class="sc-stamp add-stamp">ADD ‚úì</div></div>
      <div class="sc-body"><div class="sc-name">${r.name}</div>
      <div class="sc-meta"><span>‚è± ${r.time}</span><span>${r.cuisine}</span></div>
      <div class="sc-tags">${r.tags.map(t=>`<span class="sc-tag">${t}</span>`).join('')}</div></div>`;
    if(i===0)initSwipeGesture(c,r);
    s.appendChild(c);
  });
}
function initSwipeGesture(card,recipe){
  let sx=0,dx=0,dr=false;const sk=card.querySelector('.skip-stamp'),ad=card.querySelector('.add-stamp');
  function onS(e){sx=(e.touches?e.touches[0]:e).clientX;dr=true;card.style.transition='none';}
  function onM(e){if(!dr)return;dx=(e.touches?e.touches[0]:e).clientX-sx;card.style.transform=`translateX(${dx}px) rotate(${dx*0.05}deg)`;
    if(dx<-30){sk.style.opacity=Math.min(1,(Math.abs(dx)-30)/80);ad.style.opacity=0;}
    else if(dx>30){ad.style.opacity=Math.min(1,(dx-30)/80);sk.style.opacity=0;}
    else{sk.style.opacity=0;ad.style.opacity=0;}}
  function onE(){if(!dr)return;dr=false;card.style.transition='transform 0.3s,opacity 0.3s';
    if(dx<-120){card.style.transform='translateX(-500px) rotate(-20deg)';card.style.opacity='0';setTimeout(()=>swipeAdv('skip'),300);toast("Skipped üëã",'info');}
    else if(dx>120){card.style.transform='translateX(500px) rotate(20deg)';card.style.opacity='0';setTimeout(()=>{swipeAdv('add');moveTo(recipe.id,'meals');toast('Added to meals! üìÖ','success');},300);}
    else{card.style.transform='translateX(0) rotate(0)';sk.style.opacity=0;ad.style.opacity=0;}}
  card.addEventListener('touchstart',onS,{passive:true});card.addEventListener('touchmove',onM,{passive:true});card.addEventListener('touchend',onE);
  card.addEventListener('mousedown',onS);document.addEventListener('mousemove',onM);document.addEventListener('mouseup',onE);
}
function swipeAdv(action){
  const dots=document.querySelectorAll('.swipe-dot');
  if(swipeIdx<dots.length){dots[swipeIdx].classList.remove('current');dots[swipeIdx].classList.add(action==='add'?'added':action==='save'?'saved':'skipped');}
  swipeIdx++;if(swipeIdx<dots.length)dots[swipeIdx].classList.add('current');
  updateSwipeStack();
}
document.getElementById('swipeSaveBtn').addEventListener('click',()=>{
  const t=document.querySelector('.swipe-card.top-card');if(!t)return;
  const nm=t.querySelector('.sc-name').textContent,r=allRecipes.find(x=>x.name===nm);
  t.style.transition='transform 0.3s,opacity 0.3s';t.style.transform='translateY(-400px)';t.style.opacity='0';
  setTimeout(()=>{swipeAdv('save');if(r)moveTo(r.id,'saved');},300);toast('üîñ Saved!','amber');
});
document.getElementById('swipeAddBtn').addEventListener('click',()=>{
  const t=document.querySelector('.swipe-card.top-card');if(!t)return;
  const nm=t.querySelector('.sc-name').textContent,r=allRecipes.find(x=>x.name===nm);
  t.style.transition='transform 0.3s,opacity 0.3s';t.style.transform='translateX(500px) rotate(20deg)';t.style.opacity='0';
  setTimeout(()=>{swipeAdv('add');if(r)moveTo(r.id,'meals');},300);toast('Added to meals! üìÖ','success');
});
document.getElementById('swipeHeartBtn').addEventListener('click',function(){
  this.classList.toggle('liked');this.textContent=this.classList.contains('liked')?'‚ù§Ô∏è':'ü§ç';
  if(this.classList.contains('liked'))toast('Favourited ‚ù§Ô∏è','success');
});
document.getElementById('swipeNopeLink').addEventListener('click',()=>{
  const t=document.querySelector('.swipe-card.top-card');if(!t)return;
  const nm=t.querySelector('.sc-name').textContent,r=allRecipes.find(x=>x.name===nm);
  t.style.transition='transform 0.3s,opacity 0.3s';t.style.transform='translateY(500px)';t.style.opacity='0';
  setTimeout(()=>{swipeAdv('nope');if(r)moveTo(r.id,'dismiss');},300);dismissBanner(nm);
});

// INIT
updateUI();renderFullBrowse();renderSwipe();
</script>
</body>
</html>
